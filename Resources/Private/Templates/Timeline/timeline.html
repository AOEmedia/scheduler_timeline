{namespace s=Tx_SchedulerTimeline_ViewHelpers}

<f:layout name="module" />

<f:section name="main">

	<h2>Scheduler Timeline</h2>

	<div id="maincontainer">

		<div id="contentwrapper">
			<div id="contentcolumn">
				<div class="timeline-box">
					<div class="timeline-panel" style="width: {timelinePanelWidth}px;">

						<div id="now" style="left: {now}px"></div>

						<div class="row hours">
							<div class="timeline">
								<f:for each="{intervals}" as="hour">
									<div class="hour">{hour}</div>
								</f:for>
							</div>
						</div>

						<f:if condition="{f:count(subject: logs)} == 0">
							<div class="row">
								<div class="timeline">
								</div>
							</div>
						</f:if>

						<f:groupedFor each="{logs}" as="logOfThisTask" groupBy="task" groupKey="task">
							<f:if condition="{task}">
								<div class="row">
									<div class="timeline timeline_{task.uid}">
										<f:for each="{logOfThisTask}" as="log">
											<s:gantt log="{log}" starttime="{starttime}" zoom="{zoom}">&nbsp;</s:gantt>
											<f:render partial="Timeline/Detail" arguments="{log: log}" />
										</f:for>
									</div>
								</div>
							</f:if>
						</f:groupedFor>

					</div><!-- class="timeline-panel" -->
				</div><!-- class="timeline-box" -->
			</div><!-- id="contentcolumn" -->
		</div><!-- id="contentwrapper" -->

		<div id="leftcolumn">

			<div class="row hours">
				<div class="caption"></div>
			</div>

			<f:if condition="{f:count(subject: logs)} == 0">
				<div class="row">
					<div class="caption">
						<div class="caption-container">
							<i>No log entries found.</i>
						</div>
					</div>
				</div>
			</f:if>

			<f:groupedFor each="{logs}" as="logOfThisTask" groupBy="task" groupKey="task">
				<f:if condition="{task}">
					<div class="row">
						<div class="caption">
							<div title="{task.uid}" class="caption-container">
								<b>{task.title}</b> ({task.extension})
								<f:if condition="{task.taskObject.additionalInformation}">
									<p class="additional-information" title="{task.taskObject.additionalInformation}">
										{task.taskObject.additionalInformation}
									</p>
								</f:if>
							</div>
						</div>
					</div>
				</f:if>
			</f:groupedFor>

		</div><!-- id="leftcolumn" -->

	</div><!-- id="maincontainer" -->

	<div style="text-align: right;">
		<p><a id="jump-end" href="#" title="Jump to end">[->]</a></p>
	</div>

</f:section>
